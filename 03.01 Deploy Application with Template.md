Creating and using a template in Red Hat OpenShift is a two-step process: first, you define the template, and then you use it to deploy an application. Here is a step-by-step procedure for both with explanations.

### Step 1: Create the Application Template

The first step is to create a YAML or JSON file that defines the objects you want to deploy. This file will serve as your blueprint.

#### Procedure:

1.  **Define the `Template` object:** Start by defining the template's metadata and a description. This makes it easy to identify later.

    ```yaml
    apiVersion: template.openshift.io/v1
    kind: Template
    metadata:
      name: my-app-template
      annotations:
        description: "A simple template to deploy a basic web application."
    parameters:
    - name: APP_NAME
      description: "The name of the application."
      value: "simple-web-app"
    - name: DOCKER_IMAGE
      description: "The container image to use."
      value: "nginx:latest"
    - name: APP_REPLICAS
      description: "The number of pod replicas."
      value: "2"
    objects:
    - kind: DeploymentConfig
      apiVersion: apps.openshift.io/v1
      metadata:
        name: ${APP_NAME}
      spec:
        replicas: ${{APP_REPLICAS}}
        selector:
          app: ${APP_NAME}
        template:
          metadata:
            labels:
              app: ${APP_NAME}
          spec:
            containers:
            - name: ${APP_NAME}
              image: ${DOCKER_IMAGE}
              ports:
              - containerPort: 8080
    - kind: Service
      apiVersion: v1
      metadata:
        name: ${APP_NAME}
      spec:
        ports:
        - port: 8080
          targetPort: 8080
        selector:
          app: ${APP_NAME}
    - kind: Route
      apiVersion: route.openshift.io/v1
      metadata:
        name: ${APP_NAME}
      spec:
        to:
          kind: Service
          name: ${APP_NAME}
    ```

2.  **Add `parameters`:** In the `parameters` section, define the configurable variables. Each parameter should have a `name`, a `description`, and an optional `value` (default value). In the example above, `APP_NAME`, `DOCKER_IMAGE`, and `APP_REPLICAS` are parameters.

3.  **Include `objects`:** Under the `objects` section, list all the Kubernetes/OpenShift resources you want to create. This can include `DeploymentConfig`, `Service`, `Route`, etc. Use the `${PARAMETER_NAME}` syntax to reference the parameters you defined. For example, the `name` of the DeploymentConfig and Service is set to `${APP_NAME}`, making them dynamic.

4.  **Save the file:** Save the file with a `.yaml` or `.json` extension.

-----

### Step 2: Deploy the Application Using the Template

Once you have a template file, you can use it to deploy the application in your OpenShift project.

#### Procedure:

1.  **Log in to OpenShift:** Ensure you are logged into your OpenShift cluster via the `oc` command-line tool.

2.  **Process the template:** Use the `oc process` command to substitute the parameter values and generate the final YAML manifest. This is a crucial step for validation before you apply the resources.

    ```bash
    oc process -f my-app-template.yaml \
      -p APP_NAME=my-web-app \
      -p DOCKER_IMAGE=quay.io/openshift/hello-openshift:latest \
      -p APP_REPLICAS=3 \
      > processed-app.yaml
    ```

      * **`-f my-app-template.yaml`**: Specifies the template file to use.
      * **`-p PARAMETER_NAME=VALUE`**: Specifies the value for each parameter. You can skip parameters with a default value, or override them.
      * **`> processed-app.yaml`**: Redirects the processed output to a new YAML file. You can inspect this file to see the final configuration.

3.  **Apply the processed resources:** Use the `oc apply` command to create the resources in your project.

    ```bash
    oc apply -f processed-app.yaml
    ```

    This command will create a `DeploymentConfig`, a `Service`, and a `Route` with the names and configurations you specified via the parameters.

4.  **Alternatively, use a single command:** You can combine the processing and creation steps into a single command using a pipe.

    ```bash
    oc process -f my-app-template.yaml -p APP_NAME=my-web-app -p DOCKER_IMAGE=quay.io/openshift/hello-openshift:latest -p APP_REPLICAS=3 | oc apply -f -
    ```

This is a more direct and common way to deploy from a template. The `-f -` tells `oc apply` to read the input from the standard input (the output of `oc process`).

#### Explanation:

  * **Template Processing:** The `oc process` command is a powerful tool for template management. It takes the template file and the provided parameter values to generate a finalized manifest. This allows you to create a dynamic blueprint that can be used for different environments (e.g., development, staging, production) or applications by simply changing the parameter values.

  * **Instantiation:** When you `oc apply` the final manifest, OpenShift reads the file and creates all the defined resources, bringing your application to life. This automates the deployment of complex applications, ensuring consistency and repeatability across all your projects.
  * 


  You are correct; `oc create template` followed by `oc new-app --template` is an alternative, and often preferred, method for managing and deploying applications with templates. This two-step process separates the template's definition from its instantiation.

-----

### Step-by-Step Procedure

#### Step 1: Create and Store the Template in OpenShift

Instead of processing the template locally, you can create it as a persistent object within OpenShift. This makes the template available to everyone in a specific project or even across the entire cluster.

1.  **Define the Template:** Write your template in a YAML or JSON file, just as in the previous example. The file contains the `Template` object, its `metadata`, `parameters`, and a list of `objects`. Let's assume you have a file named `my-app-template.yaml`.

2.  **Upload the Template:** Use the `oc create` command to upload the template file to your current project's template library.

    ```bash
    oc create -f my-app-template.yaml
    ```

      * **Explanation:** This command is a standard Kubernetes API call. It reads the `Template` resource definition from your file and creates it in the cluster's etcd database. Once created, you can see it in the web console or by using the `oc get templates` command.
      * **Visibility:** By default, the template is created in your current project. To make it available to all users on the cluster, you would create it in the `openshift` project (`oc create -f my-app-template.yaml -n openshift`).

-----

#### Step 2: Deploy the Application using the Stored Template

Now that the template is stored in OpenShift, any user with the correct permissions can instantiate it without needing the local file. The `oc new-app` command is the standard way to do this.

1.  **Instantiate the Template:** Use the `oc new-app` command with the `--template` flag, followed by the template's name.

    ```bash
    oc new-app --template=my-app-template \
      -p APP_NAME=my-web-app \
      -p DOCKER_IMAGE=quay.io/openshift/hello-openshift:latest \
      -p APP_REPLICAS=3
    ```

      * **Explanation:** The `oc new-app --template` command finds the specified template (`my-app-template`) from the internal OpenShift template catalog. It then automatically processes the template by taking the values provided with the `-p` (or `--param`) flag, substituting them into the object definitions, and creating all the required resources (e.g., `DeploymentConfig`, `Service`, `Route`).
      * **Simplicity:** This method is often preferred because it's a single, concise command to deploy a complete application stack. It also leverages the built-in capabilities of OpenShift's application lifecycle management.

### Comparison of Methods

| Feature | `oc process | oc apply` | `oc create template` & `oc new-app` |
| :--- | :--- | :--- |
| **Persistence** | The template is not stored in OpenShift. It's processed locally and applied. | The template is stored as a persistent object in the cluster. |
| **Accessibility** | The user needs a local copy of the template file. | The template is available to others in the same project or cluster-wide. |
| **Command** | A two-part command using a pipe (`oc process ... | oc apply ...`). | A two-step process: `oc create template` then `oc new-app`. |
| **Best Use Case** | Quick, one-off deployments or when you don't want to store the template in the cluster. | Standardized, repeatable deployments for teams or organizations. Ideal for a shared catalog of applications. |

\<br/\>
[OpenShift Template Create and Process Template](https://www.youtube.com/watch?v=DFd0eu7pzZo)
This video demonstrates the use of both `oc create` and `oc new-app` commands to manage and deploy applications using templates in OpenShift.
http://googleusercontent.com/youtube_content/2
